import{_ as B,d as g,c as K,a as r,o as s,b as i,r as M,u as a,e as f,t as d,f as o,F as N,g as U,h as n,N as j,i as k,n as q,j as v,k as $,l as O,m as c,p as R,q as C,s as J,v as P,w as W,x as G,y as T,z as Q,A as X,B as p,C as L,D as Y}from"./logger-DTwvXM7l.chunk.mjs";var ee="M12,5A3.5,3.5 0 0,0 8.5,8.5A3.5,3.5 0 0,0 12,12A3.5,3.5 0 0,0 15.5,8.5A3.5,3.5 0 0,0 12,5M12,7A1.5,1.5 0 0,1 13.5,8.5A1.5,1.5 0 0,1 12,10A1.5,1.5 0 0,1 10.5,8.5A1.5,1.5 0 0,1 12,7M5.5,8A2.5,2.5 0 0,0 3,10.5C3,11.44 3.53,12.25 4.29,12.68C4.65,12.88 5.06,13 5.5,13C5.94,13 6.35,12.88 6.71,12.68C7.08,12.47 7.39,12.17 7.62,11.81C6.89,10.86 6.5,9.7 6.5,8.5C6.5,8.41 6.5,8.31 6.5,8.22C6.2,8.08 5.86,8 5.5,8M18.5,8C18.14,8 17.8,8.08 17.5,8.22C17.5,8.31 17.5,8.41 17.5,8.5C17.5,9.7 17.11,10.86 16.38,11.81C16.5,12 16.63,12.15 16.78,12.3C16.94,12.45 17.1,12.58 17.29,12.68C17.65,12.88 18.06,13 18.5,13C18.94,13 19.35,12.88 19.71,12.68C20.47,12.25 21,11.44 21,10.5A2.5,2.5 0 0,0 18.5,8M12,14C9.66,14 5,15.17 5,17.5V19H19V17.5C19,15.17 14.34,14 12,14M4.71,14.55C2.78,14.78 0,15.76 0,17.5V19H3V17.07C3,16.06 3.69,15.22 4.71,14.55M19.29,14.55C20.31,15.22 21,16.06 21,17.07V19H24V17.5C24,15.76 21.22,14.78 19.29,14.55M12,16C13.53,16 15.24,16.5 16.23,17H7.77C8.76,16.5 10.47,16 12,16Z",se="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z",ae="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z";const te=["aria-labelledby"],le={key:0,class:"empty-content__icon","aria-hidden":"true"},re=["id"],ie={key:2,class:"empty-content__description"},me={key:3,class:"empty-content__action"},ce=g({__name:"NcEmptyContent",props:{description:{default:""},name:{default:""}},setup(e){const m=K();return(l,t)=>(s(),r("div",{"aria-labelledby":a(m),class:"empty-content",role:"note"},[l.$slots.icon?(s(),r("div",le,[M(l.$slots,"icon",{},void 0,!0)])):i("",!0),l.name!==""||l.$slots.name?(s(),r("div",{key:1,id:a(m),class:"empty-content__name"},[M(l.$slots,"name",{},()=>[f(d(l.name),1)],!0)],8,re)):i("",!0),l.description!==""||l.$slots.description?(s(),r("p",ie,[M(l.$slots,"description",{},()=>[f(d(l.description),1)],!0)])):i("",!0),l.$slots.action?(s(),r("div",me,[M(l.$slots,"action",{},void 0,!0)])):i("",!0)],8,te))}}),S=B(ce,[["__scopeId","data-v-b101d636"]]),oe={class:"team-members"},ne={class:"team-members__list"},de={key:0,class:"team-members__more"},ue=g({__name:"TeamMembers",props:{members:{}},setup(e){return(m,l)=>(s(),r("div",oe,[o("ul",ne,[(s(!0),r(N,null,U(e.members.slice(0,5),t=>(s(),r("li",{key:t.userId||t.singleId,class:"team-members__item"},[n(a(j),{user:t.isUser?t.userId:void 0,"display-name":t.displayName,"is-no-user":!t.isUser,size:36,class:"team-members__avatar"},null,8,["user","display-name","is-no-user"]),e.members.length>5?(s(),r("span",de," +"+d(e.members.length-5),1)):i("",!0)]))),128))])]))}}),_e=k(ue,[["__scopeId","data-v-eb6b4dbf"]]),pe={class:"team-resources"},be={class:"team-resources__list"},he=["title"],ye=["href"],ve=["src","alt"],ge={key:0,class:"team-resources__box"},Ce=["href"],fe={class:"team-resources__link-more"},ke=g({__name:"TeamResources",props:{resources:{},teamUrl:{}},setup(e){return(m,l)=>(s(),r("div",pe,[o("ul",be,[(s(!0),r(N,null,U(e.resources.slice(0,5),t=>(s(),r("li",{key:t.id,class:"team-resources__box",title:t.name,style:q({"--fallback-icon":`url('${t.fallbackIcon}')`})},[o("a",{href:t.url,class:"team-resources__link"},[o("img",{src:t.iconUrl,class:"team-resources__icon",alt:t.name},null,8,ve)],8,ye)],12,he))),128)),e.resources.length>5?(s(),r("li",ge,[o("a",{href:e.teamUrl,class:"team-resources__link"},[o("div",fe,"+"+d(e.resources.length-5),1)],8,Ce)])):i("",!0)])]))}}),Ae=k(ke,[["__scopeId","data-v-10c6babe"]]),Me={class:"teams-list-item"},Ve={class:"teams-list-item__header"},we=["href"],Ie={class:"teams-list-item__header-name"},He={key:1,class:"teams-list-item__spacer"},Le=g({__name:"TeamsListItem",props:{team:{}},setup(e){return(m,l)=>(s(),r("li",Me,[o("div",Ve,[o("a",{href:e.team.url,class:"teams-list-item__header-link"},[o("h3",Ie,d(e.team.displayName),1),n(a($),{class:"teams-list-item__header-icon",inline:"",path:a(ae)},null,8,["path"])],8,we)]),e.team.members&&e.team.members.length>0?(s(),v(_e,{key:0,members:e.team.members},null,8,["members"])):i("",!0),e.team.members?.length&&e.team.resources?.length?(s(),r("div",He)):i("",!0),e.team.resources&&e.team.resources.length>0?(s(),v(Ae,{key:2,resources:e.team.resources,"team-url":e.team.url},null,8,["resources","team-url"])):i("",!0)]))}}),$e=k(Le,[["__scopeId","data-v-dbe7baef"]]),Te=["aria-label"],Ne=g({__name:"TeamsList",props:{teams:{}},setup(e,{expose:m}){m({scrollTop:t});const l=O("teamsList");function t(){l.value&&(l.value.scrollTop=0)}return(u,A)=>(s(),r("ul",{ref:"teamsList","aria-label":a(c)("circles","Teams"),class:"teams-list"},[(s(!0),r(N,null,U(e.teams,b=>(s(),v($e,{key:b.id,team:b},null,8,["team"]))),128))],8,Te))}}),Ue=k(Ne,[["__scopeId","data-v-f5172c72"]]),De={class:"teams-dashboard-widget"},Fe={key:3,class:"teams-dashboard-widget__container"},xe={key:0,class:"teams-dashboard-widget__actions"},V=3,Re=g({__name:"DashboardTeamsWidget",setup(e){const m=R("/apps/contacts/#/circles"),l=O("teamsListKey"),t=C([]),u=C(!1),A=C(!1),b=C(0),w=C(!0);J(()=>I());async function I(H=!1){u.value=!0,A.value=!1;try{const h=new URLSearchParams({limit:V.toString(),offset:b.value.toString()}),{data:D}=await P.get(W(`apps/circles/teams/dashboard/widget?${h}`)),F=D.ocs.data||[],x=F.map(y=>({id:y.singleId,displayName:y.displayName||y.name,url:y.url,members:(y.members||[]).map(_=>({userId:_.userId||_.singleId,displayName:_.displayName,type:_.type,isUser:_.type===1,url:R(`/u/${_.userId||_.singleId}`)})),resources:y.resources||[]}));H?(t.value.push(...x),b.value+=V):(t.value=x,b.value=V,G(()=>{l.value&&l.value.scrollTop()})),w.value=F.length===V}catch(h){A.value=!0,T.error("Failed to load teams",{error:h}),Q(c("circles","Failed to load teams")),H||(t.value=[])}finally{u.value=!1}}async function Z(){!w.value||u.value||await I(!0)}return(H,h)=>(s(),r("div",De,[u.value?(s(),v(a(X),{key:0,size:48})):A.value?(s(),v(a(S),{key:1,name:a(c)("circles","Failed to load teams")},{icon:p(()=>[n(a($),{path:a(se)},null,8,["path"])]),action:p(()=>[n(a(L),{onClick:h[0]||(h[0]=D=>I())},{default:p(()=>[f(d(a(c)("circles","Try again")),1)]),_:1})]),_:1},8,["name"])):t.value.length===0?(s(),v(a(S),{key:2,name:a(c)("circles","No teams found"),description:a(c)("circles","Join or create teams to see them here.")},{icon:p(()=>[n(a($),{path:a(ee)},null,8,["path"])]),action:p(()=>[n(a(L),{href:a(m)},{default:p(()=>[f(d(a(c)("circles","Create your first team")),1)]),_:1},8,["href"])]),_:1},8,["name","description"])):(s(),r("div",Fe,[n(Ue,{ref:"teamsListKey",teams:t.value},null,8,["teams"]),w.value?(s(),r("div",xe,[n(a(L),{class:"teams-dashboard-widget__show-more",disabled:u.value,variant:"secondary",wide:"",onClick:Z},{default:p(()=>[f(d(u.value?a(c)("circles","Loadingâ€¦"):a(c)("circles","More teams")),1)]),_:1},8,["disabled"])])):i("",!0)]))]))}}),Se=k(Re,[["__scopeId","data-v-16523b7c"]]),z=Y(Se);let E=!1;window.addEventListener("DOMContentLoaded",()=>{T.debug("Registering teams widget with dashboard"),window.OCA.Dashboard.register("circles",e=>{T.debug("Mounting teams widget to element",{element:e}),e.style.height="100%",E&&z.unmount(),z.mount(e),E=!0})});
//# sourceMappingURL=teams-dashboard.mjs.map
